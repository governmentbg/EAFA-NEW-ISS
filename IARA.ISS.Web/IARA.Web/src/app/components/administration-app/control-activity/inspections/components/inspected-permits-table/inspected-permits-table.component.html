<tl-card>
    <tl-card-title>{{ 'inspections.permit-licenses' | tlTranslate }}</tl-card-title>
    <tl-card-content>
        <div fxLayout="column"
             fxLayoutGap="1em"
             fxLayoutAlign="start stretch">
            <tl-data-table fxFlexFill
                           [rows]="permits"
                           [isRemote]="false"
                           [isSoftDeletable]="false"
                           [showInactiveRecords]="false"
                           [showAddButton]="!isDisabled"
                           (addButtonClicked)="onAddRecord()"
                           (recordChanged)="permitRecordChanged($event)">
                <data-column [flexRate]="0.1"
                             propertyName="licenseNumber"
                             [formGroup]="permitsFormGroup"
                             columnName="{{ 'inspections.permit-license-number' | tlTranslate }}">
                </data-column>
                <data-column [flexRate]="0.1"
                             propertyName="typeName"
                             [formGroup]="permitsFormGroup"
                             columnName="{{ 'inspections.permit-license-type' | tlTranslate }}">
                </data-column>
                <data-template-column [flexRate]="0.15"
                                      columnName="{{ 'inspections.permit-license-valid-range' | tlTranslate }}">
                    <ng-template let-row="row"
                                 ngx-datatable-cell-template>
                        <div *ngIf="row.data.from !== null && row.data.from !== undefined">
                            <span>{{ row.data.from | date: 'dd-MM-yyyy' }}</span>
                            <span> - </span>
                            <span>{{ row.data.tp | date: 'dd-MM-yyyy' }}</span>
                        </div>
                    </ng-template>
                </data-template-column>
                <data-column [flexRate]="0.2"
                             propertyName="description"
                             [formGroup]="permitsFormGroup"
                             columnName="{{ 'inspections.permit-description' | tlTranslate }}">
                </data-column>
                <data-template-column [flexRate]="0.4"
                                      columnName="{{ 'inspections.permit-license-check' | tlTranslate }}">
                    <ng-template [formGroup]="permitsFormGroup"
                                 let-row="row"
                                 ngx-datatable-cell-template>
                        <inspection-toggle *ngIf="row.editMode === true && row.data.isRegistered === true"
                                           formControlName="optionsControl"
                                           [options]="options"
                                           [toggle]="fakeToggle">
                        </inspection-toggle>
                        <span *ngIf="row.editMode === false && row.data.isRegistered === true">
                            {{ findOption(row.data.checkDTO) }}
                        </span>
                        <span
                              *ngIf="row.data.isRegistered === null || row.data.isRegistered === undefined || row.data.isRegistered === false">
                            {{ 'inspections.toggle-unregistered' | tlTranslate }}
                        </span>
                    </ng-template>
                </data-template-column>
                <data-column-inline *ngIf="!isDisabled"
                                    [flexRate]="0.07"
                                    [hideDeleteBtn]="true">
                </data-column-inline>
            </tl-data-table>

            <mat-error *ngIf="control.errors?.permitsMustBeChecked === true">
                * {{ 'inspections.permit-must-be-checked' | tlTranslate }}
            </mat-error>
        </div>
    </tl-card-content>
</tl-card>